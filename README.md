# OfficeAutomation

# 개요
- 지인의 요청으로 2023.06.03 ~ 활용한 업무 반자동화 CLI 프로그램
- Selenium을 이용한 검색 결과 분석, pyautogui를 이용한 반복 작업 자동화
- 국내 브랜드를 알리바바 클라우드에 상표로써 등록을 요청하는 작업
- 동적으로 생성되는 경우가 많아 BS4보다 Selenium 선택
- 화면을 절반씩 차지하는 크롬 두개를 열어 타겟을 모니터의 특정 좌표에 고정한 후 pyautogui를 이용해 캡쳐 후 입력을 반복

# 목표
1. 대상 브랜드가 알리바바에 등록되지 않은 경우 신규 브랜드로 양식 작성 후 신청
2. 대상 브랜드가 알리바바에 등록되어 있는 경우 기존 브랜드로 양식 작성 후 신청

# 해결 아이디어 - 목표 1
1. Selenium으로 https://tm.aliyun.com/ 에 접속하고 html을 분석하여 검색창 찾기
2. input()을 통해 입력 받은 브랜드명을 검색창에 입력하고 검색
3. 검색 결과가 표시된 후 https://www.naver.com/ 에 접속하여 같은 키워드로 검색
4. 검색 결과중 대상 브랜드가 존재하지 않거나 검색 결과가 없는 경우 대상 브랜드의 상품 판매 페이지를 로고와 함께 캡쳐
5. 홍크 브랜드 운영 플랫폼으로 이동하여 신규 브랜드 탭으로 이동 후 브랜드 명 입력, 국가(대한 민국) 선택, 이미지 등록

# 해결 아이디어 - 목표 2
1. 목표 1의 해결아이디어 1~3과 동일
2. 검색 결과 화면은 20개까지 표시되므로, 20개 중 몇 번째에 위치하는지 콘솔에 입력하여 해당 요소의 상표 세부 정보로 이동하여 캡쳐 (1페이지에 없는 경우 없다고 가정)
4. 홍크 브랜드 운영 플랫폼으로 이동하여 기존 브랜드 탭에서 브랜드 명, 등록 번호, 상표 소유자명, 상표 세부 정보 캡쳐 이미지 등록

# 제한사항
1. 상표 세부정보 페이지의 봇 탐지 (BS4 접근 불가능) : 검색 결과에서 href 태그를 찾아 pyautogui를 이용하여 직접 접속으로 해결
2. 동일 브랜드인지 비교는 간단한 알고리즘으로는 구현 불가능 : 수작업 실시
3. 웹사이트의 로딩 속도로 인해 예상치 못한 오류 발생 가능성 높음 : 모니터링하며 오류 발생 시 재시작
4. 홍크 브랜드 운영 플랫폼의 robots.txt 확인 결과 모든 경로 크롤링 불가능 : pyautogui와 clipboard를 이용하여 양식 직접 입력 후 제출
5. 

# 사전 작업
1. 1920*1080 해상도 모니터를 주 모니터로 설정, 화면 왼쪽 절반은 크롬 브라우저 탭 1개 이상 오픈, 오른쪽은 홍크 브랜드 운영 플랫폼 로그인
2. 본 소스코드는 크롬 북마크 탭이 열린 상태로 진행되었음. 환경에 따라 pyautogui.moveTo() 파라미터 값이 다를 수 있음.

# 사용 효과
- 기존 25개/시간 정도로 책정되었던 작업 속도를 평균 57개/시간으로 2배 이상 증가 (총 13시간 작업, 약 750개 브랜드 등록 요청), 최적의 경우 30초만에 1개의 요청 등록 가능하였음.
- 단순 반복 작업을 자동화하고 사람의 지능이 필요한 부분만 수작업으로 남겨두어 육체적/정신적 피로 감소

# 필요개선점
- 5시간 정도의 간단한 코딩과 테스트로 만든 결과물로써, Selenium에 대한 이해가 완전하지 않은 상태로 작성하여 비효율적이고 예외 처리가 부족함
- 모든 프로세스가 직렬로 구성되어 있어 중간에 오류가 발생하는 경우 처음 알리바바 브랜드 검색 사이트 접속부터 다시 시작해야 함.
